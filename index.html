<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Mi App</title>
    
    <!-- Supabase Client -->
    <script src="./supabase.js"></script>
    
    <!-- Material Web offline import map -->
    <script type="importmap">
    {
        "imports": {
            "@material/web": "./vendor/material-web/all.js",
            "@material/web/": "./vendor/material-web/",
            "@lit/reactive-element": "./vendor/@lit/reactive-element/reactive-element.js",
            "@lit/reactive-element/": "./vendor/@lit/reactive-element/",
            "lit-html": "./vendor/lit-html/lit-html.js",
            "lit-html/": "./vendor/lit-html/",
            "lit-element": "./vendor/lit-element/lit-element.js",
            "lit-element/": "./vendor/lit-element/",
            "lit": "./vendor/lit/index.js",
            "lit/": "./vendor/lit/",
            "tslib": "./vendor/tslib/tslib.es6.js"
        }
    }
    </script>
    <script type="module">
        import '@material/web/typography/md-typescale-styles.js';
        import '@material/web/button/filled-button.js';
        import '@material/web/button/text-button.js';
        import '@material/web/button/filled-tonal-button.js';
        import '@material/web/iconbutton/icon-button.js';
        import '@material/web/textfield/outlined-text-field.js';
        import '@material/web/fab/fab.js';
    </script>
    
    <!-- Application Styles -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div id="splash-screen">
        <div id="splash-loader"></div>
        <span id="splash-text" class="md-typescale-body-medium">Iniciando...</span>
    </div>
    
    <div id="app-container"></div>
    
    <div class="bottom-sheet-overlay" id="bottom-sheet-menu" onclick="closeBottomSheet()"></div>
    <div class="modal-overlay" id="modal-overlay"></div>

    <!-- Templates for dynamic views -->
    <template id="template-login">
        <div id="login-view" class="view">
            <main class="content">
                <header class="auth-header">
                    <span class="icon" style="--icon-url:url('./icons/login.svg');" aria-hidden="true"></span>
                    <h1 class="md-typescale-headline-medium">Bienvenido</h1>
                </header>
                
                <form id="login-form" onsubmit="event.preventDefault(); handleLogin();">
                    <md-outlined-text-field
                        id="l-email"
                        label="Correo electrónico"
                        type="email"
                        autocomplete="email"
                        required
                        style="width: 100%; margin-bottom: 16px;">
                    </md-outlined-text-field>
                    
                    <md-outlined-text-field
                        id="l-pass"
                        label="Contraseña"
                        type="password"
                        autocomplete="current-password"
                        required
                        style="width: 100%; margin-bottom: 16px;">
                    </md-outlined-text-field>
                    
                    <md-filled-button type="submit" style="width:100%;margin-top:16px;">
                        Iniciar Sesión
                    </md-filled-button>
                    <md-text-button type="button" style="width:100%;margin-top:8px;" onclick="showSubView('register')">
                        Crear una cuenta
                    </md-text-button>
                </form>
                
                <form id="register-form" style="display:none;" onsubmit="event.preventDefault(); handleRegister();">
                    <md-outlined-text-field
                        id="r-email"
                        label="Correo electrónico"
                        type="email"
                        autocomplete="email"
                        required
                        style="width: 100%; margin-bottom: 16px;">
                    </md-outlined-text-field>
                    
                    <md-outlined-text-field
                        id="r-pass"
                        label="Contraseña (mín 6 caracteres)"
                        type="password"
                        minlength="6"
                        required
                        style="width: 100%; margin-bottom: 16px;">
                    </md-outlined-text-field>
                    
                    <md-outlined-text-field
                        id="r-pass-confirm"
                        label="Confirmar contraseña"
                        type="password"
                        required
                        style="width: 100%; margin-bottom: 16px;">
                    </md-outlined-text-field>
                    
                    <md-filled-button type="submit" style="width:100%;margin-top:16px;">
                        Crear Cuenta
                    </md-filled-button>
                    <md-text-button type="button" style="width:100%;margin-top:8px;" onclick="showSubView('login')">
                        Ya tengo una cuenta
                    </md-text-button>
                </form>
            </main>
        </div>
    </template>
    
    <template id="template-menu">
        <div id="menu-view" class="view">
            <header class="top-bar">
                <h2 class="top-bar-title md-typescale-title-large" id="page-title">Productos</h2>
                <div id="status-chip" class="status-chip md-typescale-label-small" role="status" aria-live="polite">
                    <div class="status-dot"></div>
                    <span id="status-text">...</span>
                </div>
            </header>
            
            <main class="content">
                <section id="products-page" class="page" aria-label="Página de productos"></section>
                <section id="store-page" class="page" aria-label="Página de tienda"></section>
                <section id="settings-page" class="page" aria-label="Página de ajustes"></section>
            </main>
            
            <md-fab 
                class="fab" 
                id="fab" 
                onclick="openProductModal()" 
                aria-label="Agregar nuevo producto"
            >
                <span class="icon" slot="icon" style="--icon-url:url('./icons/add.svg');" aria-hidden="true"></span>
            </md-fab>
            
            <nav class="nav-bar" aria-label="Navegación principal">
                <button 
                    class="nav-item" 
                    data-page="products-page" 
                    onclick="navigateTo('products-page', this)"
                    aria-label="Productos"
                >
                    <div class="nav-icon">
                        <span class="icon" style="--icon-url:url('./icons/inventory-2.svg');" aria-hidden="true"></span>
                    </div>
                    <span class="nav-label md-typescale-label-medium">Productos</span>
                </button>
                <button 
                    class="nav-item" 
                    data-page="store-page" 
                    onclick="navigateTo('store-page', this)"
                    aria-label="Tienda"
                >
                    <div class="nav-icon">
                        <span class="icon" style="--icon-url:url('./icons/storefront.svg');" aria-hidden="true"></span>
                    </div>
                    <span class="nav-label md-typescale-label-medium">Tienda</span>
                </button>
                <button 
                    class="nav-item" 
                    data-page="settings-page" 
                    onclick="navigateTo('settings-page', this)"
                    aria-label="Ajustes"
                >
                    <div class="nav-icon">
                        <span class="icon" style="--icon-url:url('./icons/settings.svg');" aria-hidden="true"></span>
                    </div>
                    <span class="nav-label md-typescale-label-medium">Ajustes</span>
                </button>
            </nav>
        </div>
    </template>

    <!-- Main Application Script -->
    <script type="module" src="js/main.js"></script>
</body>
</html>
