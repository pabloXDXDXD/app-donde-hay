<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Mi App</title>
    
    <!-- Supabase Client -->
    <script src="./supabase.js"></script>
    
    <!-- Material Web offline import map -->
    <script type="importmap">
    {
        "imports": {
            "@material/web": "./vendor/material-web/all.js",
            "@material/web/": "./vendor/material-web/",
            "@lit/reactive-element": "./vendor/@lit/reactive-element/reactive-element.js",
            "@lit/reactive-element/": "./vendor/@lit/reactive-element/",
            "lit-html": "./vendor/lit-html/lit-html.js",
            "lit-html/": "./vendor/lit-html/",
            "lit-element": "./vendor/lit-element/lit-element.js",
            "lit-element/": "./vendor/lit-element/",
            "lit": "./vendor/lit/index.js",
            "lit/": "./vendor/lit/",
            "tslib": "./vendor/tslib/tslib.es6.js"
        }
    }
    </script>
    <script type="module">
        import '@material/web/typography/md-typescale-styles.js';
        import '@material/web/button/filled-button.js';
        import '@material/web/button/text-button.js';
        import '@material/web/button/filled-tonal-button.js';
        import '@material/web/iconbutton/icon-button.js';
        import '@material/web/textfield/outlined-text-field.js';
        import '@material/web/fab/fab.js';
    </script>
    
    <!-- Application Styles -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div id="splash-screen">
        <div id="splash-loader"></div>
        <span id="splash-text" class="md-typescale-body-medium">Iniciando...</span>
    </div>
    
    <div id="app-container"></div>
    
    <div class="bottom-sheet-overlay" id="bottom-sheet-menu" onclick="closeBottomSheet()"></div>
    <div class="modal-overlay" id="modal-overlay"></div>

    <!-- Templates for dynamic views -->
    <template id="template-login">
        <div id="login-view" class="view">
            <main class="content">
                <header class="auth-header">
                    <svg viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 8V6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9zm9 12H6V10h12v10zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2z"/>
                    </svg>
                    <h1 class="md-typescale-headline-medium">Bienvenido</h1>
                </header>
                
                <form id="login-form" onsubmit="event.preventDefault(); handleLogin();">
                    <md-outlined-text-field
                        id="l-email"
                        label="Correo electrónico"
                        type="email"
                        autocomplete="email"
                        required
                        style="width: 100%; margin-bottom: 16px;">
                    </md-outlined-text-field>
                    
                    <md-outlined-text-field
                        id="l-pass"
                        label="Contraseña"
                        type="password"
                        autocomplete="current-password"
                        required
                        style="width: 100%; margin-bottom: 16px;">
                    </md-outlined-text-field>
                    
                    <md-filled-button type="submit" style="width:100%;margin-top:16px;">
                        Iniciar Sesión
                    </md-filled-button>
                    <md-text-button type="button" style="width:100%;margin-top:8px;" onclick="showSubView('register')">
                        Crear una cuenta
                    </md-text-button>
                </form>
                
                <form id="register-form" style="display:none;" onsubmit="event.preventDefault(); handleRegister();">
                    <md-outlined-text-field
                        id="r-email"
                        label="Correo electrónico"
                        type="email"
                        autocomplete="email"
                        required
                        style="width: 100%; margin-bottom: 16px;">
                    </md-outlined-text-field>
                    
                    <md-outlined-text-field
                        id="r-pass"
                        label="Contraseña (mín 6 caracteres)"
                        type="password"
                        minlength="6"
                        required
                        style="width: 100%; margin-bottom: 16px;">
                    </md-outlined-text-field>
                    
                    <md-outlined-text-field
                        id="r-pass-confirm"
                        label="Confirmar contraseña"
                        type="password"
                        required
                        style="width: 100%; margin-bottom: 16px;">
                    </md-outlined-text-field>
                    
                    <md-filled-button type="submit" style="width:100%;margin-top:16px;">
                        Crear Cuenta
                    </md-filled-button>
                    <md-text-button type="button" style="width:100%;margin-top:8px;" onclick="showSubView('login')">
                        Ya tengo una cuenta
                    </md-text-button>
                </form>
            </main>
        </div>
    </template>
    
    <template id="template-menu">
        <div id="menu-view" class="view">
            <header class="top-bar">
                <h2 class="top-bar-title md-typescale-title-large" id="page-title">Productos</h2>
                <div id="status-chip" class="status-chip md-typescale-label-small" role="status" aria-live="polite">
                    <div class="status-dot"></div>
                    <span id="status-text">...</span>
                </div>
            </header>
            
            <main class="content">
                <section id="products-page" class="page" aria-label="Página de productos"></section>
                <section id="store-page" class="page" aria-label="Página de tienda"></section>
                <section id="settings-page" class="page" aria-label="Página de ajustes"></section>
            </main>
            
            <md-fab 
                class="fab" 
                id="fab" 
                onclick="openProductModal()" 
                aria-label="Agregar nuevo producto"
            >
                <svg slot="icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                </svg>
            </md-fab>
            
            <nav class="nav-bar" aria-label="Navegación principal">
                <button 
                    class="nav-item" 
                    data-page="products-page" 
                    onclick="navigateTo('products-page', this)"
                    aria-label="Productos"
                >
                    <div class="nav-icon">
                        <svg viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M20 2H4c-1 0-2 .9-2 2v3.01c0 .72.43 1.34 1 1.69V20c0 1.1 1.1 2 2 2h14c.9 0 2-.9 2-2V8.7c.57-.35 1-.97 1-1.69V4c0-1.1-1-2-2-2zm-5 12H9v-2h6v2zm5-7H4V4h16v3z"/>
                        </svg>
                    </div>
                    <span class="nav-label md-typescale-label-medium">Productos</span>
                </button>
                <button 
                    class="nav-item" 
                    data-page="store-page" 
                    onclick="navigateTo('store-page', this)"
                    aria-label="Tienda"
                >
                    <div class="nav-icon">
                        <svg viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M20 4H4v2h16V4zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6h1zm-9 4H6v-4h6v4z"/>
                        </svg>
                    </div>
                    <span class="nav-label md-typescale-label-medium">Tienda</span>
                </button>
                <button 
                    class="nav-item" 
                    data-page="settings-page" 
                    onclick="navigateTo('settings-page', this)"
                    aria-label="Ajustes"
                >
                    <div class="nav-icon">
                        <svg viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M19.14 12.94c.04-.31.06-.63.06-.94s-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59-.24-1.13-.57-1.62-.94l-2.39-.96c-.22-.08-.47 0 .59-.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18-.14-.23-.41-.12-.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>
                        </svg>
                    </div>
                    <span class="nav-label md-typescale-label-medium">Ajustes</span>
                </button>
            </nav>
        </div>
    </template>

    <!-- Main Application Script -->
    <script type="module" src="js/main.js"></script>
</body>
</html>
